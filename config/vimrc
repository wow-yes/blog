set nocompatible        " 避免以前版本的一些bug和局限
syntax on        "设置语法高亮
filetype on
filetype plugin on
filetype indent on    "自动检测文件类型并进行缩进高亮

let mapleader=" "

set path+=**
set wildmenu

set lazyredraw          " 延迟重绘（提升性能）
set ttyfast             " 快速终端连接
set magic               " 使用正则魔法模式 搜索优化
set linebreak           " 在单词边界折行
set showbreak=↪\        " 折行显示符号
set shortmess+=a
set backspace=indent,eol,start  " 更好的退格键行为
set whichwrap+=<,>,h,l  " 光标行首行尾时自动换行

set shiftwidth=4        " 设置制表符宽度"
set expandtab           " 用空格代替制表符
set tabstop=4           " 设置制表符宽度"
set softtabstop=4

set nobomb
set encoding=utf-8

set autoindent          " 继承前一行的缩进方式，特别适用于多行注释
set clipboard=unnamed   " 共享剪贴板

set number              " 设置行号
set hlsearch
set incsearch           " 在搜索时，输入的词句的逐字符高亮（类似firefox的搜索）

set tw=81
set cc=81

set showmatch           " 显示匹配的括号
set autoread
set autowrite
set nowrap
set cursorline

set title
set titlestring=%F

set laststatus=2        " 显示状态栏
set noshowmode          " 状态栏下面不在单独显示模式

" 1. 设置目录列表样式为树形 (默认是0: 精简列表)
let g:netrw_liststyle = 3

" 2. 设置打开文件的方式：在新水平分割窗口中打开
"    (可选值: 1-在新水平窗口, 2-在新垂直窗口, 3-在新标签页, 4-在之前的窗口)
let g:netrw_browse_split = 2

" 3. 设置文件浏览器窗口的宽度 (例如: 25%)
let g:netrw_winsize = 25

" 4. 隐藏/显示横幅 (0: 隐藏横幅, 1: 显示横幅)
let g:netrw_banner = 0

" 5. 让Netrw的浏览目录跟随Vim的当前目录
let g:netrw_keepdir = 0

if executable('rg')
  set grepprg=rg\ --vimgrep\ --no-heading\ --smart-case
  set grepformat=%f:%l:%c:%m
endif

set undofile  "使得即使在文件关闭后也可以维护撤消历史记录
if !isdirectory(expand("~/.vim/undofiles"))
    call mkdir($HOME . "/.vim/undofiles", "p")
endif
set undodir=~/.vim/undofiles

set backup            "允许生成备份文件"
if !isdirectory(expand("~/.vim/backupfiles"))
    call mkdir($HOME . "/.vim/backupfiles", "p")
endif
set backupdir=~/.vim/backupfiles

set swapfile          "允许生成swap文件"
if !isdirectory(expand("~/.vim/swapfiles"))
    call mkdir($HOME . "/.vim/swapfiles", "p")
endif
set dir=~/.vim/swapfiles//

func! SetFortran()    
    let s:extfname = expand("%:e")
    if s:extfname ==? "f90"
        let fortran_free_source=1
        unlet! fortran_fixed_source
    elseif s:extfname ==? "F90"
        let fortran_free_source=1
        unlet! fortran_fixed_source
    else
        let fortran_fixed_source=1
        unlet! fortran_free_source
    endif
    let fortran_more_precise=1
    "去掉固定格式每行开头的红色填充
    let fortran_have_tabs=1
    "允许折叠
    let fortran_do_enddo=1
    let fortran_fold=1
    let fortran_fold_conditionals=1
endfunc

set bg=dark
colorscheme desert
